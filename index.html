<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>淺草風神籤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入 Noto Serif JP 與 TC 以呈現日式與漢文美感 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@300;500;700&family=Noto+Serif+TC:wght@300;500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --shrine-red: #C62828;
            --shrine-wood: #5D4037;
            --shrine-wood-dark: #3E2723;
            --shrine-wood-light: #8D6E63;
            --paper-white: #F9F7F2;
            --ink-black: #2c2c2c;
        }

        body {
            font-family: 'Noto Serif JP', 'Noto Serif TC', serif;
            background-color: #f0f0f0;
            background-image: radial-gradient(#e0e0e0 1px, transparent 1px);
            background-size: 20px 20px;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        /* 隱藏 Scrollbar 但保留功能 */
        * {
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        *::-webkit-scrollbar {
            display: none;
        }

        /* 籤筒 */
        .kuji-container {
            perspective: 1000px;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 2rem;
            position: relative;
            z-index: 30;
        }
        
        .kuji-container:hover {
            transform: translateY(-5px);
        }

        .kuji-box {
            width: 160px;
            height: 260px;
            background: linear-gradient(90deg, #6D4C41 0%, #8D6E63 20%, #5D4037 50%, #8D6E63 80%, #6D4C41 100%);
            position: relative;
            border-radius: 4px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4), inset 0 0 30px rgba(0,0,0,0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 10;
        }

        .kuji-label {
            background-color: var(--paper-white);
            padding: 15px 10px;
            writing-mode: vertical-rl;
            font-size: 1.6rem;
            font-weight: 700;
            color: var(--ink-black);
            border: 3px solid var(--ink-black);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            letter-spacing: 0.3em;
        }

        .kuji-top {
            position: absolute;
            top: -20px;
            left: 0;
            width: 100%;
            height: 40px;
            background: #4E342E;
            border-radius: 50%;
            box-shadow: 0 5px 5px rgba(0,0,0,0.3);
            z-index: 5;
        }
        
        .kuji-hole {
            position: absolute;
            top: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 20px;
            height: 12px;
            background-color: #1a1a1a;
            border-radius: 50%;
            z-index: 6;
            box-shadow: inset 0 0 5px rgba(0,0,0,0.8);
        }

        /* 籤棒 */
        .stick {
            position: absolute;
            left: 50%;
            top: 0;
            transform: translateX(-50%) translateY(0);
            width: 10px;
            height: 180px;
            background: #EFEBE9;
            border-radius: 2px;
            z-index: 4;
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            opacity: 0;
            display: flex;
            align-items: flex-start;
            justify-content: center;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            border: 1px solid #d7ccc8;
        }

        .stick-text {
            font-size: 12px;
            writing-mode: vertical-rl;
            margin-top: 12px;
            color: #C62828;
            font-weight: bold;
            letter-spacing: 2px;
        }

        /* 搖晃動畫 */
        @keyframes shake {
            0% { transform: rotate(0deg); }
            20% { transform: rotate(-5deg); }
            40% { transform: rotate(5deg); }
            60% { transform: rotate(-5deg); }
            80% { transform: rotate(5deg); }
            100% { transform: rotate(0deg); }
        }

        .shaking {
            animation: shake 0.8s cubic-bezier(.36,.07,.19,.97) both;
        }

        /* Modal 遮罩 */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
        }

        .overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        /* 卷軸容器 */
        .scroll-container {
            position: relative;
            width: 90%;
            max-width: 380px;
            height: auto;
            max-height: 85vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            transform: scaleY(0);
            transform-origin: center;
            transition: transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .overlay.active .scroll-container {
            transform: scaleY(1);
        }

        /* 卷軸上下桿 */
        .scroll-roller-top, .scroll-roller-bottom {
            width: calc(100% + 40px);
            height: 36px;
            background: linear-gradient(to bottom, #5D4037 0%, #8D6E63 40%, #3E2723 100%);
            border-radius: 4px;
            position: relative;
            z-index: 20;
            box-shadow: 0 4px 8px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .scroll-roller-top::before, .scroll-roller-top::after,
        .scroll-roller-bottom::before, .scroll-roller-bottom::after {
            content: '';
            width: 12px;
            height: 28px;
            background: #3E2723;
            border-radius: 2px;
            margin: 0 4px;
            box-shadow: inset 0 0 2px rgba(0,0,0,0.8);
        }
        
        .roller-highlight {
            position: absolute;
            top: 10%;
            left: 10px;
            right: 10px;
            height: 2px;
            background: rgba(255,255,255,0.2);
            border-radius: 2px;
        }

        /* 卷軸紙張 */
        .scroll-paper {
            width: 100%;
            background-color: var(--paper-white);
            color: var(--ink-black);
            position: relative;
            padding: 35px 24px;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.5' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100' height='100' filter='url(%23noise)' opacity='0.08'/%3E%3C/svg%3E");
            background: linear-gradient(to bottom, rgba(0,0,0,0.1) 0%, transparent 20px, transparent calc(100% - 20px), rgba(0,0,0,0.1) 100%), var(--paper-white);
        }

        /* 內容樣式 */
        .omikuji-content {
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .kuji-number {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
            color: #666;
            letter-spacing: 0.1em;
            text-align: center;
            width: 100%;
        }

        .kuji-rank {
            font-size: 3.2rem;
            font-weight: 900;
            color: var(--shrine-red);
            margin-bottom: 1.5rem;
            font-family: "Noto Serif TC", serif;
            line-height: 1;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
            text-align: center;
            width: 100%;
        }
        
        .poem-container {
            width: 100%;
            background-color: rgba(255,255,255,0.4);
            border: 1px solid rgba(0,0,0,0.05);
            padding: 20px 15px;
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
        }

        .poem-section {
            display: flex;
            flex-direction: row-reverse;
            gap: 1.2rem;
        }

        .poem-line {
            writing-mode: vertical-rl;
            font-size: 1.1rem;
            line-height: 1.4;
            letter-spacing: 0.15em;
            height: 140px;
            font-weight: 500;
            font-family: "Noto Serif TC", serif;
        }

        .poem-explanation {
            width: 100%;
            font-size: 0.95rem;
            color: #444;
            line-height: 1.8;
            text-align: justify;
            padding: 0 10px;
            margin-bottom: 20px;
        }
        
        .explanation-title {
            font-weight: 700;
            color: var(--shrine-wood);
            margin-bottom: 6px;
            font-size: 1rem;
            text-align: center;
        }

        /* 詳細運勢網格 - 對齊修正 */
        .details-grid {
            display: flex;
            flex-direction: column;
            gap: 10px;
            width: 85%;
            max-width: 300px;
            margin: 0 auto;
            padding-top: 15px;
            border-top: 1px solid #ccc;
            font-size: 0.9rem;
        }

        .detail-item {
            display: flex;
            align-items: baseline;
            line-height: 1.5;
        }

        .detail-label {
            width: 4.5em;
            flex-shrink: 0;
            font-weight: 700;
            color: var(--shrine-wood);
            margin-right: 12px;
            text-align: justify;
            text-align-last: justify;
        }
        
        .detail-text {
            color: #333;
            text-align: left;
            flex-grow: 1;
        }

        .close-btn {
            margin-top: 30px;
            padding: 8px 40px;
            background-color: var(--shrine-red);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1rem;
            letter-spacing: 0.1em;
            transition: transform 0.1s, background 0.2s;
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }
        
        .close-btn:hover {
            background-color: #b71c1c;
            transform: translateY(-1px);
        }

        /* 背景特效 */
        .mist-bg {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
            opacity: 0.4;
            background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 60%);
            pointer-events: none;
        }
        
        .sakura {
            position: absolute;
            color: #ffcdd2;
            font-family: serif;
            opacity: 0.6;
            z-index: 0;
            user-select: none;
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(10deg); }
        }

    </style>
</head>
<body class="flex flex-col justify-center items-center relative">

    <div class="mist-bg"></div>
    <div class="sakura" style="top: 15%; left: 10%; font-size: 24px; animation-delay: 0s;">❀</div>
    <div class="sakura" style="top: 25%; right: 12%; font-size: 20px; animation-delay: 1s;">❀</div>
    <div class="sakura" style="bottom: 20%; left: 15%; font-size: 22px; animation-delay: 2s;">❀</div>
    <div class="sakura" style="bottom: 10%; right: 20%; font-size: 18px; animation-delay: 3s;">❀</div>

    <!-- 主要互動區域 -->
    <div class="relative flex flex-col items-center z-20 w-full max-w-md px-4">
        <!-- 籤筒 -->
        <div class="kuji-container" id="kujiContainer" onclick="drawOmikuji()">
            <div class="stick" id="stick">
                <span class="stick-text" id="stickText"></span>
            </div>
            <div class="kuji-box">
                <div class="kuji-top"></div>
                <div class="kuji-hole"></div>
                <div class="kuji-label">浅草觀音</div>
            </div>
        </div>

        <!-- 提示 -->
        <div class="text-center opacity-90">
            <p class="text-xl font-bold text-stone-700 tracking-[0.2em] mb-2 drop-shadow-sm" style="font-family: 'Noto Serif TC', serif;">心中默念祈願</p>
            <div class="h-px w-24 bg-stone-400 mx-auto mb-2 opacity-50"></div>
            <p class="text-sm text-stone-500 tracking-widest">輕觸籤筒 誠心抽籤</p>
        </div>
    </div>

    <!-- 籤詩 Modal -->
    <div class="overlay" id="overlay">
        <div class="scroll-container">
            <div class="scroll-roller-top"><div class="roller-highlight"></div></div>
            
            <div class="scroll-paper">
                <div class="omikuji-content" id="resultContent"></div>
                <button class="close-btn" onclick="closeResult()">收起籤詩</button>
            </div>
            
            <div class="scroll-roller-bottom"><div class="roller-highlight"></div></div>
        </div>
    </div>

    <script>
        // 壓縮的籤詩資料：[番號, 吉凶, 詩句(以|分隔), 簡解, 細項(願望|疾病|失物|等待的人|搬家|旅行)]
        // 這是基於淺草寺觀音百籤的公開資料
        const rawData = [
    [1, "大吉", "七寶浮圖塔|高峰頂上安|眾人皆仰望|莫作等閒看", "如同七寶塔聳立高峰，才德兼備受眾人景仰。此非凡庸之兆，切勿看輕自己，持續精進必成大業。", "所願皆能實現|病根盡除痊癒|失物終將復得|遲來但會出現|遷居諸事大吉|旅途毫無災厄"],
    [2, "小吉", "月被浮雲翳|立事自昏迷|幸乞陰公祐|何慮不開眉", "如月亮被浮雲遮蔽，眼前世事混沌難明。但若多積陰德祈求神佑，雲霧終散，愁眉自開。", "誠心祈求則靈|需長久調養|耐心尋找可見|受阻礙會遲來|暫緩變動為宜|近處旅遊吉利"],
    [3, "凶", "愁惱損忠良|青霄一炷香|雖然防小過|閒慮覺時長", "無謂的煩惱損害身心，雖燒香祈福，但若不謹言慎行防範小過錯，焦慮的日子將覺漫長。", "願望難以實現|病況恐將拖延|難以尋回|恐怕不會出現|不宜變動居所|旅途恐有阻礙"],
    [4, "吉", "累有興雲志|君恩祿未封|若逢侯手印|好事始總總", "雖有沖天壯志但時運未到。一旦得到貴人（侯手印）提拔賞識，喜事便會接二連三發生。", "晚成大器可望|遇良醫將治癒|有人報信將出|等待之人將至|遷居吉利|旅途一路順風"],
    [5, "凶", "家道未能昌|危危保禍殃|暗雲侵月桂|佳人一炷香", "家運目前不昌隆，危機四伏。如同烏雲侵蝕月光，只能如佳人般誠心祈禱，以求保平安。", "難以達成心願|病情恐會拖延|失物難以尋回|等待之人不來|守舊不宜搬遷|旅途不利"],
    [6, "末吉", "宅墓鬼凶多|人事有爻訛|傷財防損失|祈福始中和", "家宅運勢不安，人際關係多糾紛。需慎防破財，多行善祈福才能將災禍轉為平穩。", "阻礙多難實現|病期長需耐心|難以再次見到|遲遲不見蹤影|不宜急躁變動|旅途恐有不順"],
    [7, "凶", "登舟待便風|月色暗矇矓|欲碾香輪去|高山千萬重", "想乘船卻無風助，月色昏暗不明。前路如高山重重阻隔，時運艱難，不宜妄動。", "時機未到難成|病情險峻|失物已無蹤影|音訊全無|暫不宜搬遷|路途險阻重重"],
    [8, "大吉", "會有金門客|愛君如寶珍|利名皆得意|遠大世間人", "將遇高貴之人視你如珍寶。名利雙收，志向遠大，終將成為世間有名望的成就者。", "願望順利實現|疾病即將痊癒|失物即將出現|等待之人將至|搬遷大吉大利|旅途大吉"],
    [9, "大吉", "有名須得遇|三望一朝遷|貴人來指處|華果應時鮮", "名聲顯揚，願望達成。得貴人指點迷津，運勢如花果應時綻放，鮮美且美好。", "萬事皆能如意|疾病早日康復|失物自然出現|等待之人即來|搬遷吉利|旅途平安順心"],
    [10, "凶", "舊用多成破|新更始見財|改求雲外望|枯木遇春開", "守舊則破敗，創新局才見財源。眼光應放遠於雲外，如枯木逢春般，唯有改變才有生機。", "改換目標則吉|難以短期治癒|失物難尋|相見之期尚遠|宜變動居所|旅途有驚無險"],
    [11, "吉", "有祿興家業|文華達帝都|雲中乘好箭|兼得貴人扶", "家業興隆有福祿，才華可達京城受肯定。如箭射雲中鵠的，又有貴人相助，前程似錦。", "願望可以達成|疾病逐漸癒合|失物終將出現|等待之人會來|搬遷吉利|旅途順遂"],
    [12, "大吉", "楊柳遇春時|殘花發舊枝|重重霜雪裡|黃金色更輝", "如楊柳逢春，舊枝重開新花。歷經重重霜雪考驗後，運勢如黃金般更加耀眼奪目。", "大器晚成之象|沉痾終將痊癒|失物能夠尋回|等待之人將至|搬遷吉利|旅途愉快"],
    [13, "吉", "手把太陽輝|東君發舊枝|稼苗方欲秀|猶更上雲梯", "手中掌握光輝，枯枝重新發芽。如禾苗正秀，運勢步步高升，更上一層樓。", "願望可以實現|疾病將會痊癒|失物能夠尋回|等待之人將至|搬遷吉利|旅途吉利"],
    [14, "凶", "玉石未分時|憂心轉更悲|前途通大道|花發應殘枝", "真偽未分，憂心轉悲。雖眼前有大道，但時機未對，如殘枝勉強開花，恐難長久。", "願望難以實現|拖延難治|難以尋回|不會出現|凶象不宜搬遷|旅途恐有凶險"],
    [15, "凶", "年乖數亦孤|久病未能蘇|岸危舟未發|龍臥失明珠", "時運不濟，孤立無援。久病難癒，處境危險如岸邊危舟，又如龍失明珠，進退維谷。", "願望無法達成|病情危急|失物難以復得|杳無音訊|不宜變動|旅途凶多吉少"],
    [16, "大吉", "破改重成望|前途喜亦寧|貴人相助處|祿馬照前程", "破舊立新，願望重成。前途喜慶安寧，得貴人相助，福祿雙全照亮前程。", "願望必能達成|疾病必定痊癒|失物能夠出現|等待之人將至|搬遷吉利|旅途吉利"],
    [17, "凶", "怪異防憂惱|人宅見分離|惜花還值雨|杯酒惹閑非", "怪事引發憂惱，親人骨肉分離。惜花卻遭雨打，杯酒之間惹是非，凡事需謹慎。", "願望難以實現|病期長恐拖延|失物無蹤|等待之人不來|搬遷凶|旅途恐惹是非"],
    [18, "吉", "離暗出明時|麻衣變綠衣|舊憂終是退|遇祿應交輝", "脫離黑暗重見光明，貧賤轉為富貴（麻衣變綠衣）。舊憂消退，福祿光輝相映。", "願望終將達成|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [19, "末吉", "家道生荊棘|兒孫防虎威|香前祈福厚|方得免分離", "家道艱難如生荊棘，需防子孫惹禍。唯有誠心祈福積德，方能免於骨肉分離之苦。", "難以達成心願|病情拖延|失物難尋|遲遲不來|守舊為宜|旅途不宜"],
    [20, "吉", "月出漸分明|家財每每興|何言先有滯|更變立功名", "月出雲散，家財漸興。別在意過去的停滯，勇於改變變通，即可建立功名。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [21, "吉", "洗出經年否|光華得再清|所求終吉利|重日照前程", "洗去多年的霉運，光華再次清明。所求終將吉利，前程如雙日照耀般光明。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [22, "吉", "漸漸濃雲散|看看月再明|逢春華果秀|雨過竹重青", "濃雲漸散，月色重明。苦盡甘來，逢春花果秀麗，雨過後竹林更顯青翠。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [23, "吉", "紅雲隨步起|一箭中青霄|鹿行千里遠|爭知去路遙", "吉兆隨行，一舉成名如箭射雲霄。雖志在千里路途遙遠，但前程遠大。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [24, "凶", "肘後道符靈|匣中劍有聲|雖然常得勝|爭奈有金兵", "雖身懷絕技（符靈劍鳴）常得勝，但強中自有強中手，恐遇強敵金兵，不可大意。", "願望難以實現|病情險峻|失物難尋|等待之人不來|搬遷凶|旅途凶"],
    [25, "吉", "克日事成功|前途發舊崇|口書言信至|炎火欲燒空", "指日可待成功，祖德庇佑前途。喜信將至，運勢氣場旺盛如火燎原。", "願望即將實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [26, "吉", "將軍有異聲|進兵萬里程|爭知臨敵處|道貌卻和平", "將軍威名遠播，萬里長征。臨敵時卻能以和為貴，不戰而屈人之兵，智勇雙全。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [27, "凶", "家舍防憂患|笙歌惹禍胎|身如浮水萍|口舌引官災", "家有憂患，沈迷享樂將惹禍。身不由己如浮萍，需防口舌招來官司是非。", "願望無法實現|疾病凶險|失物無蹤|等待之人不來|搬遷凶|旅途凶多吉少"],
    [28, "凶", "若是名利客|須防月半深|不宜行此事|只可暫寬心", "若是求名利者，月中需防變卦。目前不宜妄動行事，暫且寬心等待時機。", "願望難以實現|病情拖延|失物難尋|遲遲不來|守舊等待|旅途凶"],
    [29, "吉", "寶劍出匣時|匣中應不留|貴人相接引|名利逐無休", "寶劍出匣，鋒芒畢露。得貴人接引提拔，名利雙收，運勢勢不可擋。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [30, "凶", "仙鶴立高枝|防他暗箭虧|井畔剛刀利|戶內更防危", "雖處高位如鶴立枝頭，需防暗箭傷人。處境危險如臨井畔刀鋒，家中更需防範災禍。", "願望難以實現|處境危險|失物難尋|等待之人不來|搬遷凶|旅途凶"],
    [31, "末吉", "鯤鯨未變時|且守碧潭溪|風雲興巨浪|一息過天涯", "大魚尚未化鳥，暫守溪潭沈潛。待風雲起興巨浪，便可一氣飛越天涯。", "等待時機可成|病情拖延|失物遲遲未現|等待之人遲來|暫時守舊|旅途吉利"],
    [32, "吉", "似玉藏深石|休將故眼看|一朝良匠別|方見寶光寒", "如美玉藏於石中，莫用舊眼光看輕。待良匠開鑿，方見寶光閃耀，大器晚成。", "願望晚成|疾病將痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [33, "吉", "枯木逢春艷|芳菲再發林|雲間方見月|前遇貴人欽", "枯木逢春，林間花開。撥雲見月，運勢轉好，前途得貴人欽重相助。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [34, "大吉", "出入行藏禮|松梢鶴並棲|風高飛一舉|萬里快雲蹄", "行事合乎禮節，如鶴棲松般高雅。趁風高飛，如駿馬萬里疾馳，無往不利。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [35, "吉", "射鹿須乘箭|故僧引路歸|遇道同仙籍|光華映晚輝", "射鹿需乘機，得高人指路。與道合者同行，晚景光華，越老運勢越好。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [36, "末吉", "先凶後吉時|崇山深處基|一箭中紅粉|名利好相隨", "先苦後甘，根基深厚如在崇山。一擊必中目標（紅粉），名利將自然相隨。", "運勢漸入佳境|疾病漸漸痊癒|失物遲遲出現|等待之人遲來|搬遷吉利|旅途吉利"],
    [37, "半吉", "陰慮未消融|雖危未害終|一舟過大江|更藉一帆風", "心中憂慮未消，雖有險阻但無大害。如小舟渡大江，還需順風相助方能成功。", "需待時機|疾病漸癒|失物難尋|等待之人遲來|搬遷吉利|旅途吉利"],
    [38, "半吉", "月照天書靜|雲生霧彩霞|久想離庭客|一朝復舊家", "月照文書靜好，雲生祥瑞彩霞。離家許久的遊子，終將歸鄉團聚，重修舊好。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [39, "凶", "望用何多滯|移居未得安|層層多阻隔|心腹恐相干", "所求多停滯，移居亦不安寧。阻隔重重，恐有傷及心腹之患，需特別小心。", "願望難以實現|病情拖延|失物難尋|等待之人不來|搬遷凶|旅途凶"],
    [40, "小吉", "中間成喜事|精神事大亨|舊憂都不覺|漸更有前程", "途中將遇喜事，精神大振。舊憂盡忘，前程漸入佳境，越來越好。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [41, "末吉", "有物不周旋|須防損本源|榮華如夢電|且待月團圓", "物資準備不周，需防損及根本。榮華如夢幻泡影，且耐心等待月圓時機成熟。", "暫且守舊|注意保養身體|失物難尋|等待之人遲來|耐心等待|旅途暫緩"],
    [42, "吉", "無蹤亦無跡|遠近終難覓|平地起波瀾|所求終未得", "平地起波瀾，前路茫茫無蹤跡。雖然目前所求難得，但保持平靜，雲霧散去轉機自現。", "大器晚成|需耐心調養|失物難尋|遲至|暫緩搬遷|近處旅遊可"],
    [43, "大吉", "捷報已占魁|皇都得意回|青雲梯上步|高折桂枝開", "捷報傳來奪魁，得意歸來。平步青雲直上，高折桂枝，功名成就之大吉兆。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [44, "吉", "盤石圖前古|松篁長茂林|一朝逢匠手|無價是知音", "根基穩固如磐石，如松茂林。一朝遇識貨匠手，知音最無價，才能得發揮。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [45, "大吉", "採藥天台路|溪山雲霧深|其中如得寶|脫卻凡俗心", "如入天台山採藥，雲霧雖深。但若得仙藥至寶，便能脫胎換骨，超凡入聖。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [46, "凶", "雷發震天昏|佳人獨掩門|交加飛鳥道|無處避災瘟", "雷震天昏地暗，孤獨掩門無助。災禍交加而來，彷彿無處可避，需極度謹慎。", "願望凶|病情危急|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [47, "吉", "更望身前立|東風引路開|改更還重望|福祿日邊來", "立身揚名，幸有東風引路。若能改變方向重新期望，福祿將如日昇般到來。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [48, "小吉", "昆鳥秋來化|風輕翼倍加|一舉凌空去|高飛玩物華", "秋來大魚化鳥，風輕助翼展。一飛沖天凌空而去，盡情賞玩人間風華。", "晚成大器|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [49, "凶", "凍冰消水面|日出漸光輝|龍蛇猶尚滯|教道轉雲梯", "冰雖消融，日雖出，但龍蛇尚困滯未能升天。目前仍處困境，需待轉機。", "等待時機|病情拖延|失物難尋|等待之人遲來|守舊為宜|旅途需待"],
    [50, "吉", "有定終須定|心危所事危|貴人皆指引|好處信疑遲", "定數已定，雖心危事危。幸有貴人引路，好事在後頭，切勿遲疑不信。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [51, "凶", "修進甚艱難|勞心未得安|舟書空在水|龍臥失清潭", "修身進取艱難，勞心而不安。如舟書空轉水中，龍失深潭無處容身，時運不濟。", "願望難成|病情拖延|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [52, "凶", "月色被雲遮|雲深處處遮|看看光欲暗|卻是未周全", "月被雲層遮蔽，處處昏暗不明。光芒將盡，萬事未周全，前途黯淡。", "願望凶|病情長久|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [53, "吉", "久困嘆塵埃|誰知意趣乖|一朝脫羅網|富貴出天台", "久困塵埃之中，事與願違。一旦衝破羅網脫困，富貴自天而來。", "先難後成|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [54, "凶", "夢中得寶玉|貪得轉無光|爭知花葉敗|那更雪風霜", "夢中得寶終是空，貪多反而失光彩。花敗葉落，更遭風霜摧殘，運勢低迷。", "願望虛幻|病情沈重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [55, "吉", "父老傳音信|石中出美玉|庶人問求財|子母多相續", "長輩將傳來佳音，石中鑿出美玉。求財得利，利上滾利（子母相續），財源滾滾。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [56, "末吉", "生涯必有虧|約定不相隨|早月光猶暗|誰知霧散時", "生計恐有虧損，約定難以成真。月光尚暗，唯有耐心等待霧散之時。", "守舊保身|多加保重|失物難尋|遲遲不來|耐心等待|旅途需待"],
    [57, "大吉", "樂之極矣悲|射鹿未乘機|其怪恐防損|前途有是非", "樂極生悲，射鹿失機。需防怪事損害，前程恐有是非。（註：雖名大吉，實含警惕，意在持盈保泰）", "謹慎行事|疾病將癒|失物將出|等待之人將來|守舊為宜|旅途守舊"],
    [58, "小吉", "可嘆前途事|明珠在土埋|一朝光照徹|萬里見光彩", "前途暫時可嘆，如明珠埋土。一朝光透土層，萬里生輝，前景將一片光明。", "晚成之象|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [59, "凶", "杳杳無音信|道遠信難通|平地起風煙|草木盡霜紅", "音訊杳然，路遠難通。平地起風波，草木盡經霜紅，景象蕭條。", "願望難成|病情危險|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [60, "小吉", "高臺栽翠柳|濃綠幾千重|一步高一層|切須防缺空", "如高台栽柳，綠意千重。雖步步高升，但高處不勝寒，切記防備跌落缺空。", "謹慎可成|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [61, "大吉", "日上東方起|光明照萬方|家風生吉慶|樹葉茂芬芳", "旭日東昇，光照萬方。家運吉慶，枝繁葉茂芬芳，充滿生機與希望。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [62, "大吉", "災遭去禍煩|家門生福苑|福海欲通津|金闕迎高選", "災禍盡除，家門生福氣。福如東海通達，如入金闕受高選，功名顯赫。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [63, "凶", "散財多怪異|憂患兩相欺|空船歸去客|前途恐是非", "散財之事怪異，憂患接連而來。如客乘空船而歸，前途恐惹是非口舌。", "破財耗損|病情加重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [64, "凶", "魚遊釜中水|火急甚燃眉|在路崩騰走|危難日日隨", "如魚遊鍋中水，火燒眉毛般危急。奔波勞碌，危難日日相隨，處境艱難。", "願望凶|病情緊急|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [65, "末吉", "苦病喜更醫|前途喜會期|不學無術客|一紙薦君知", "久病喜得良醫，前途有轉機。雖無學術背景，但得貴人一紙推薦而知名。", "疾病漸癒|病情好轉|失物將出|等待之人將至|搬遷吉利|旅途吉利"],
    [66, "凶", "水滯少波濤|飛鴻落羽毛|重憂心緒亂|閒事惹風騷", "水流停滯，飛鴻落毛。憂心如焚心緒亂，管閒事反惹一身腥。", "運勢停滯|病期長久|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [67, "凶", "才發君心天|那知下塵埃|飛鴻常折翼|名利總成灰", "心比天高，身陷塵埃。如飛鴻折翼，名利最終化為灰燼，一場空。", "願望失敗|病情加重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [68, "吉", "春谷變氣候|一舉起雷聲|身顯名傳遠|作事自作成", "春谷氣候變暖，一聲春雷驚人。身名遠揚，事事自然成就，順風順水。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [69, "凶", "如鳥飛失翼|猛虎失山林|進退身無措|難會意中人", "如鳥失雙翼，虎落平陽失山林。進退失據無措，難以會見意中人，孤立無援。", "願望難成|病情加重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [70, "吉", "雷發庭前草|炎火向天飛|一心來趕祿|爭奈掩朱扉", "雷驚庭草，氣勢如火向天飛。一心求祿，奈何朱門緊閉。（註：此籤意指先難後獲，需堅持）", "晚成大器|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [71, "凶", "腳踏黃泥路|路通馬不前|家舍防災害|運氣未周圓", "腳踏泥濘難行，路通但馬不前。家中需防災害，運氣尚未周圓，凡事受阻。", "運勢停滯|病期長久|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [72, "吉", "戶內防重厄|花果見分枝|嚴霜才過後|方始見光輝", "需先防家內災厄，花果分枝散葉。待嚴霜過後，方能見到光輝，先苦後甘。", "先苦後甘|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [73, "大吉", "久暗漸分明|登江綠水澄|芝書從天降|終得異人成", "久暗運勢漸明，江水澄澈見底。詔書自天而降，終得異人（貴人）相助成就大業。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [74, "大吉", "蛇身意欲化|春雨吸靈津|金鱗翻碧沼|玉角透青雲", "蛇欲化龍，吸飲春雨靈津。金鱗翻騰碧沼，玉角穿透青雲，飛黃騰達之象。", "大器大成|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [75, "凶", "宛如抱虎眠|惡事上心間|虛言生怪異|閒事惹官權", "驚險如抱虎而眠，惡事盤據心頭。虛言生怪異，管閒事惹上官司權力之爭。", "處境危險|病情險峻|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [76, "吉", "富貴天之授|何須苦用心|前程盡通達|珠玉滿衣襟", "富貴乃上天授予，何須苦苦用心強求。前程自然通達，珠玉寶物滿衣襟。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [77, "凶", "夢中如得寶|醒來都不見|山水路迢迢|若行多改換", "夢中得寶，醒來成空。山水路途遙遠，若執意前行恐多變故，徒勞無功。", "願望虛幻|病情加重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [78, "吉", "雲開霧便散|好月照重樓|春風綠楊柳|無事可干休", "雲開霧散，明月照亮重樓。春風吹綠楊柳，閒適無憂，萬事順心。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [79, "吉", "前途亦可營|萬事早完成|立身欲富貴|名譽得高榮", "前途可以經營，萬事早早完成。立身處世富貴，名譽高榮，心想事成。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [80, "大吉", "深山多種玉|瓦石變黃金|一樹開花鮮|枝枝色耀心", "如在深山種玉，瓦石亦能變黃金。一樹鮮花盛開，枝枝色彩耀眼人心。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [81, "小吉", "道合調琴瑟|玄陰鬼賊多|一途雖通達|含毒氣相和", "琴瑟雖和鳴，但周圍小人（鬼賊）多。路途雖通達，但氣氛中暗藏毒害，需謹慎。", "慎防小人|多做調養|失物難尋|遲遲不來|暫時守舊|旅途吉利"],
    [82, "凶", "火發恐連天|屍骸遍野地|中間龍劍落|何事得周全", "火勢連天之災，屍骸遍野。象徵權力的龍劍失落，何事能得周全？大凶之兆。", "大凶之象|病情危急|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [83, "大吉", "我本天仙雷|偶來人世間|看看十二路|誰不羨神仙", "本是天仙雷神，偶來人世間遊歷。看遍四面八方（十二路），誰不羨慕這般神仙際遇。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [84, "凶", "否極方見泰|花發再重開|這事宜更改|名利恐招災", "否極才會泰來，花落才會重開。目前之事宜更改方向，強求名利恐招災禍。", "改換目標則吉|病期長久|失物無蹤|等待之人不來|宜改不宜守|旅途凶"],
    [85, "凶", "一尾銜花鹿|周圍獵戶多|若離弓箭難|此去始中和", "如鹿銜花而走，周圍獵戶伺機而動。若能逃離弓箭之難，方能得到平安中和。", "處境險惡|病情危急|失物無蹤|等待之人不來|避禍為宜|旅途凶"],
    [86, "大吉", "春來花發枝|甘雨滋嫩葉|大振家聲處|祿爵自相隨", "春來花發枝頭，甘雨滋潤嫩葉。大振家族聲望，高官厚祿自然相隨。", "大器大成|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [87, "大吉", "高山玉石中|良匠採連城|探地求賢士|羅衣衣錦榮", "高山藏玉石，良匠採得連城璧。探地求得賢士，終能衣錦還鄉，榮耀門楣。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [88, "吉", "威勢萬人頭|事事占上游|韶華今已至|束帛又封侯", "威勢凌駕萬人，事事力爭上游。美好的時光已至，即將封侯拜相，功成名就。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [89, "大吉", "出入營謀大|朝中用賢士|一舉登高科|雙飛如鳳翅", "營謀計畫宏大，朝中重用賢士。一舉高登金榜，如鳳凰雙翅般雙宿雙飛，大展宏圖。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [90, "大吉", "一信向天飛|秦川舟自歸|前途成好事|應得貴人推", "喜信飛向天際，迷舟自秦川歸來。前途盡是好事，應得貴人推舉，萬事亨通。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [91, "吉", "改變前途去|月桂又逢圓|雲中乘祿至|凡事可宜先", "改變前途方向，月桂缺而重圓。雲中福祿將至，凡事宜搶得先機，不可落後。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [92, "大吉", "自幼常為客|心勞意不寧|一朝逢好運|榮耀滿門庭", "自幼客居異鄉，心勞意亂不寧。一朝好運降臨，榮耀將充滿門庭，光宗耀祖。", "大器晚成|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [93, "吉", "有魚臨旱池|跳躍欲生機|一朝得春雨|濟化上天池", "如旱池之魚，跳躍求生機。一朝得春雨滋潤，便能化龍飛上天池。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [94, "半吉", "事親須孝敬|天意亦相扶|天然生福果|名利自然無", "孝敬父母雙親，天意自會相扶。雖有天然福果，但名利目前不顯，宜知足常樂。", "平常心看待|疾病將癒|失物將出|等待之人將來|搬遷吉利|旅途吉利"],
    [95, "吉", "志氣功業在|名利亦相隨|一朝逢好運|龍虎鎮門楣", "志氣高昂，功業在望。好運一到，名利相隨，如龍虎鎮守門楣，威風八面。", "願望可以實現|疾病將會痊癒|失物將會出現|等待之人將至|搬遷吉利|旅途吉利"],
    [96, "大吉", "雞犬相逢日|求君便得通|萬事皆如意|喜氣自然濃", "雞犬相逢之吉日，所求便得通達。萬事皆能如意，喜氣自然濃厚。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [97, "凶", "當風點巨燭|風吹燭欲滅|祭祀神不顯|良醫致病歇", "風中點巨燭，搖搖欲滅之象。祭神神不顯靈，良醫亦束手無策，險象環生。", "願望凶|病情危急|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [98, "凶", "欲買桂花酒|爭奈小人何|庫中財物失|名利總蹉跎", "欲買美酒慶祝，奈何小人作梗。庫中財物遭竊，名利總是蹉跎錯過。", "破財耗損|病情加重|失物無蹤|等待之人不來|搬遷凶|旅途凶"],
    [99, "大吉", "紅日當門照|名利盡高升|貴人相引接|百事自然成", "紅日當門高照，名利步步高升。得貴人引接提拔，百事自然成就，無往不利。", "願望大吉|疾病痊癒|失物將出現|等待之人將至|搬遷吉利|旅途吉利"],
    [100, "凶", "祿走白雲間|攜琴走遠山|不遇神仙面|空惹意闌珊", "福祿隱於白雲間，攜琴歸隱遠山。不遇神仙點化，只能空惹意興闌珊，孤芳自賞。", "願望落空|病情危急|失物無蹤|等待之人不來|搬遷凶|旅途凶"]
];

        // 將原始資料轉換為物件陣列
        const omikujiData = rawData.map(item => {
            const detailsArray = item[4].split('|');
            return {
                number: `第${item[0]}番`,
                rank: item[1],
                poem: item[2].split('|'),
                explanation: item[3],
                details: {
                    "願望": detailsArray[0],
                    "疾病": detailsArray[1],
                    "失物": detailsArray[2],
                    "等待的人": detailsArray[3],
                    "搬家": detailsArray[4],
                    "旅行": detailsArray[5]
                }
            };
        });

        let isDrawing = false;
        const container = document.getElementById('kujiContainer');
        const stick = document.getElementById('stick');
        const stickText = document.getElementById('stickText');
        const overlay = document.getElementById('overlay');
        const resultContent = document.getElementById('resultContent');

        // 將阿拉伯數字轉換為中文數字
        function toChineseNum(num) {
            const chineseNums = ['零', '一', '二', '三', '四', '五', '六', '七', '八', '九'];
            const units = ['', '十', '百'];
            let str = num.toString();
            let result = '';
            
            if (num === 100) return '百';
            if (num < 10) return chineseNums[num];
            if (num < 20) return '十' + (num % 10 === 0 ? '' : chineseNums[num % 10]);
            
            let unitIndex = 0;
            for (let i = str.length - 1; i >= 0; i--) {
                const n = parseInt(str[i]);
                if (unitIndex === 0) { // 個位
                    if (n !== 0) result = chineseNums[n];
                } else if (unitIndex === 1) { // 十位
                    if (n !== 0) result = chineseNums[n] + '十' + result;
                    else if (result !== '') result = '零' + result;
                }
                unitIndex++;
            }
            return result;
        }

        function getRandomOmikuji() {
            return omikujiData[Math.floor(Math.random() * omikujiData.length)];
        }

        function drawOmikuji() {
            if (isDrawing) return;
            isDrawing = true;

            container.classList.add('shaking');
            
            // 隨機抽取
            const result = getRandomOmikuji();
            
            setTimeout(() => {
                container.classList.remove('shaking');
                
                // 處理籤棒文字：去除 "第" 與 "番"，轉換為中文數字 (如 42 -> 四十二)
                // 原始資料 number 格式為 "第42番"，我們先取出數字部分
                const numStr = result.number.replace(/[^\d]/g, '');
                const num = parseInt(numStr);
                stickText.innerText = toChineseNum(num);
                
                stick.style.opacity = '1';
                stick.style.transform = 'translateX(-50%) translateY(-130px)';
                
                setTimeout(() => {
                    showResult(result);
                }, 1000);

            }, 1000);
        }

        function showResult(data) {
            let detailsHtml = '';
            for (const [key, value] of Object.entries(data.details)) {
                detailsHtml += `
                    <div class="detail-item">
                        <span class="detail-label">${key}</span>
                        <span class="detail-text">${value}</span>
                    </div>
                `;
            }

            resultContent.innerHTML = `
                <div class="kuji-number">${data.number}</div>
                <div class="kuji-rank">${data.rank}</div>
                
                <div class="poem-container">
                    <div class="poem-section">
                        ${data.poem.map(line => `<div class="poem-line">${line}</div>`).join('')}
                    </div>
                </div>

                <div class="poem-explanation">
                    <div class="explanation-title">【解說】</div>
                    <p>${data.explanation}</p>
                </div>

                <div class="details-grid">
                    ${detailsHtml}
                </div>
            `;

            overlay.classList.add('active');
        }

        function closeResult() {
            overlay.classList.remove('active');
            
            setTimeout(() => {
                stick.style.transition = 'none';
                stick.style.transform = 'translateX(-50%) translateY(0)';
                stick.style.opacity = '0';
                
                setTimeout(() => {
                    stick.style.transition = 'transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275)';
                    isDrawing = false;
                }, 50);
            }, 500);
        }
    </script>
</body>
</html>